!function(e){e.fn.chosenClassPrefix=function(){return e(this).is('[class^="chzn-"]')?"chzn":"chosen"},e.fn.chosenOrder=function(){var i=this.filter("."+this.chosenClassPrefix()+"-sortable[multiple]").first(),s=i.siblings("."+this.chosenClassPrefix()+"-container");return e(s.find("."+this.chosenClassPrefix()+'-choices li[class!="search-field"]').map((function(){if(this)return i.find("option:contains("+e(this).text()+")")[0]})))},e.fn.chosenSortable=function(){this.filter("."+this.chosenClassPrefix()+"-sortable[multiple]").each((function(){var i=e(this),s=i.siblings("."+i.chosenClassPrefix()+"-container");if(e.ui){s.find("."+i.chosenClassPrefix()+"-choices").bind("mousedown",(function(i){e(i.target).is("span")&&i.stopPropagation()}));var n=s.find("."+i.chosenClassPrefix()+"-choices"),r=i.attr("data-index-order")||"";if(r.length)for(var t in(r=r.split(",")).reverse(),r)n.prepend(n.find(".search-choice [data-option-array-index='"+(r[t]-1)+"']").parent());n.sortable({placeholder:"search-choice-placeholder",items:"li:not(.search-field)",tolerance:"pointer",start:function(e,i){i.placeholder.width(i.item.outerWidth()),i.placeholder.height(i.item.outerHeight())}}),i.closest("form")&&i.closest("form").bind("submit",(function(){if(i.filter("."+i.chosenClassPrefix()+"-sortable[multiple]").first().siblings("."+i.chosenClassPrefix()+"-container").length>0){var e=i.chosenOrder();i.children().remove(),i.append(e)}}))}else console.error("jquery-chosen-sortable requires JQuery UI to have been initialised.")}))}}(jQuery);